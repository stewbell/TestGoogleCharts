<!-- Copyright 2018 Google LLC.
SPDX-License-Identifier: Apache-2.0 -->

<!DOCTYPE html>
<html lang="en">

<head>
  <title>Hello!</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/style.css">
  <script src="https://apis.google.com/js/api.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="javascript/dnd.js"></script>
  <script src="javascript/classes.js"></script>
  <script src="javascript/data.js"></script>
</head>

<body>
  <div class=heading>
    <h1>Smash</h1>
  </div>
  <div class=pagelayout>
    <div></div>
    <div id="mainChart" class="mainChart">
      <script>
        google.charts.load('current', { 'packages': ['corechart'] });
        mainChart = new chart("mainChart");
        gapi.load("client:auth2", function () {
         auth22 = gapi.auth2.init({ client_id: "15273187460-elptddbevnsgd3f0fvo39cdn13h48ugs.apps.googleusercontent.com" });
         console.log("auth22", auth22)
        })
        //gapi.load.onload = function(){queryAndLoadChart()};

        function login() {
          database = authenticate().then(loadClient)
          // mainChart.drawChart(database);
        }
        function initialChart() {
          return gapi.client.bigquery.jobs.query({
            "projectId": "modelsales1",
            "resource": {
              "query": "CALL `modelsales1.model4.InitialProcedure`();",
              "useLegacySql": false,
            }
          })
            .then(function (response) {
              // Handle the results here (response.result has the parsed body).
              mainChart.drawChart(response)

            },
              function (err) { console.error("Execute error", err); });
        }
      
       
      

       
        function APITestLoop(){
          var startTime = new Date()
          
       console.log("start", startTime.getTime()/1000)
          for (i=1;i<3;i++){
            APIcall(startmilliseconds);
          }
          console.log("End call");
        }
        
        
        
        function APIcall(startmilliseconds) {
          
          fetch('https://automl.googleapis.com/v1beta1/projects/modelsales1/locations/us-central1/models/TBL1605922494273814528:predict', {
            method: 'POST', // or 'PUT'
            headers: {
              'Content-Type': 'application/json',
              'Authorization': 'Bearer ya29.a0AfH6SMA7T1UwrW8lmx49q951E5d_fVWlcaIv3WRiBUxtee9DEc23cRyRtazjh9_SFsGqBSRbcHnDDoWQNvTZwv1obIDJpDmS-nCqE5GTDesjyeRsAQODa7ocUGKhR5Z7G3hnFSh1MnGBB4A_Wzc8Xx2WYQCcsXoJv97K'  
              },
            body: JSON.stringify(APIdata),
          })
            .then(response => response.json())
            .then(data => {
              var lapTime = new Date();
              console.log('Success:', lapTime.getTime()/1000, data);            })
        
            .catch((error) => {
              console.error('Error:', error);
            });
        }
      </script>
      <button onclick="login()">login</button>
      <button onclick="initialChart()">initial Chart</button>
      <button onclick="APITestLoop()">API AutoML call</button>
    </div>
    <div></div>
    <div></div>
    <div class="container">
      <script>

        counter = 1;
        for (row = 0; row < 10; row++) {
          document.write('<div class="boxheading" >' + ProductList[row].Product + '</div>')
          for (col = 0; col < 12; col++) {
            document.write(' <div draggable="true" class="box" id=' + counter++ + '></div>')
          }
        }
      </script>
    </div>
    <div id="promoBoard" class="promoBoard">
      <div draggable="true" class="promoBox" style="background-color:aqua;">PriceOff1</div>
      <div draggable="true" class="promoBox" style="background-color:blueviolet;">PriceOff2</div>
      <div draggable="true" class="promoBox" style="background-color:yellowgreen">FreePack1</div>
      <div draggable="true" class="promoBox" style="background-color:tomato">ExtraSize1</div>


    </div>
  </div>


</body>

</html>